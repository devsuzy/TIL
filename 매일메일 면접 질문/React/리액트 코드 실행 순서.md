# 리액트 코드 실행 순서

> 매일메일 FE 2025년 7월 3주차 목요일 질문

```js
import { useState, useEffect } from 'react';

function Parent() {
  const [count, setCount] = useState(0);

  console.log('1');

  useEffect(() => {
    console.log('2');
    return () => {
      console.log('3');
    };
  }, [count]);

  return (
    <div>
      <p>카운트: {count}</p>
      <button onClick={() => setCount((prev) => prev + 1)}>+1</button>
      <Child value={count} />
    </div>
  );
}

function Child({ value }) {
  console.log('4');

  useEffect(() => {
    console.log('5');
    return () => {
      console.log('6');
    };
  }, []);

  return <p>자식 값: {value}</p>;
}

export default Parent;
```

### 최초 마운트 시
`1 -> 4 -> 5 -> 2`
- `Parent` 컴포넌트가 렌더링되면서 `1` 출력
- `Parent` 컴포넌트 내 `Child` 컴포넌트가 렌더링되어 `4` 출력
- `Child`의 `useEffect`가 실행되어 `5` 출력
    - 의존성 배열이 비어있기 때문에 최초 마운트 시에만 한 번 실행되고, 이후에는 다시 실행되지 않음
- `Parent`의 `useEffect`가 실행되어 `2` 출력

### 최초 버튼 클릭 시
`1 -> 4 -> 3 -> 2`
- `count` 상태가 변경되었기 때문에 `Parent` 컴포넌트가 다시 렌더링 되어 `1` 출력
- `Parent` 컴포넌트 내 `Child` 컴포넌트가 다시 렌더링 되면서 `4` 출력
- `Parent`의 `useEffect`가 실행되기 전에 이전 `useEffect`의 클린업 함수가 먼저 실행되어 `3` 출력
- `count` 상태가 변경되었기 때문에 `Parent`의 `useEffct`가 다시 실행되어 `2` 출력

